---
title: "Data check report 2.0"
output: pdf_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r include=FALSE}
library("RTaxometrics")
library("dplyr")
```

Load the data
```{r}
data <- read.csv("oxford_hgshsa_260820_modded.csv", sep = ";")
```

Get rid of N/A
```{r}
data <- na.omit(data)
```
We've lost 18 participants

# Checking the data

## Involuntariness data: separate items

Create a subset with involuntariness ratings:

```{r}
invol <- select(data, INV.1:INV.12)
```

Headers for the resulting table:
```{r echo=FALSE}
colnames(invol)
```

### P = 0.15

Classify the data with .15 base rate:
```{r}
invol15 <- ClassifyCases(invol, p = 0.15)
```

Check the data:
```{r error = TRUE}
CheckData(invol15)
```

### P = 0.10

Classify the data with .10 base rate:
```{r}
invol10 <- ClassifyCases(invol, p = 0.10)
```

Check the data:
```{r error = TRUE}
CheckData(invol10)
```

## Involuntariness data: separate items ("bad" items removed)

Create a subset with involuntariness ratings without "bad" items:
```{r}
invol_purified <- select(data, INV.3:INV.10)
```
Headers for the resulting table:
```{r echo=FALSE}
colnames(invol_purified)
```

### P = 0.15

Classify the data with .15 base rate:
```{r}
invol_pur15 <- ClassifyCases(invol_purified, p = 0.15)
```

Check the data:
```{r error = TRUE}
CheckData(invol_pur15)
```

### P = 0.10

Classify the data with .10 base rate:
```{r}
invol_pur10 <- ClassifyCases(invol_purified, p = 0.10)
```

Check the data:
```{r error = TRUE}
CheckData(invol_pur10)
```

## Involuntariness data: subscales

Create subscales
```{r}
invol$ideomotor <- invol$INV.1 + invol$INV.2 + invol$INV.3 + invol$INV.7
invol$challenge <- invol$INV.4 + invol$INV.5 + invol$INV.6 + invol$INV.8 + invol$INV.10
invol$cogper <- invol$INV.9 + invol$INV.11
invol$amnesia <- invol$INV.12
```

Headers for the resulting table (showing only subscales columns):
```{r echo = FALSE}
select(invol, ideomotor, challenge, cogper, amnesia) %>%
  colnames()
```

### P = 0.15

Classify the data with .15 base rate:
```{r}
invol_subscales15 <- select(invol, ideomotor, challenge, cogper, amnesia)
invol_subscales15 <- ClassifyCases(invol_subscales15, p = 0.15)
```

Check the data:
```{r error = TRUE}
CheckData(invol_subscales15)
```

### P = 0.10

Classify the data with .10 base rate:
```{r}
invol_subscales10 <- select(invol, ideomotor, challenge, cogper, amnesia)
invol_subscales10 <- ClassifyCases(invol_subscales10, p = 0.10)
```

Check the data:
```{r error = TRUE}
CheckData(invol_subscales10)
```


## Involuntariness data: subscales ("bad" items removed)

Create subscales
```{r}
invol_purified$ideomotor <- invol_purified$INV.3 + invol_purified$INV.7
invol_purified$challenge <- invol_purified$INV.4 + invol_purified$INV.5 + invol_purified$INV.6 + invol_purified$INV.8 + invol_purified$INV.10
invol_purified$cogper <- invol_purified$INV.9
```

Headers for the resulting table (showing only subscales columns):
```{r echo=FALSE}
select(invol_purified, ideomotor, challenge, cogper) %>%
  colnames()
```

### P = 0.15

Classify the data with .15 base rate:
```{r}
invol_subscales_pur15 <- select(invol_purified, ideomotor, challenge, cogper)
invol_subscales_pur15 <- ClassifyCases(invol_subscales_pur15, p = 0.15)
```

Check the data:
```{r error = TRUE}
CheckData(invol_subscales_pur15)
```

### P = 0.10

Classify the data with .10 base rate:
```{r}
invol_subscales_pur10 <- select(invol_purified, ideomotor, challenge, cogper)
invol_subscales_pur10 <- ClassifyCases(invol_subscales_pur10, p = 0.10)
```

Check the data:
```{r error = TRUE}
CheckData(invol_subscales_pur10)
```


## Hypnotic suggestibility data: separate items

Create a H. suggestibility subset
```{r}
hab <- select(data, HGSHS.A1:HGSHS.A11, HGSHS.A12)
```

Headers for the resulting table:
```{r echo=FALSE}
colnames(hab)
```

### P = 0.15

Classify the data with .15 base rate:
```{r}
hab15 <- ClassifyCases(hab, p = 0.15)
```

Check the data:
```{r error = TRUE}
CheckData(hab15)
```

### P = 0.10

Classify the data with .10 base rate:
```{r}
hab10 <- ClassifyCases(hab, p = 0.10)
```

Check the data:
```{r error = TRUE}
CheckData(hab10)
```

## Hypnotic suggestibility data: separate items ("bad" items removed)

Create a H. suggestibility subset without "bad" items
```{r}
hab_purified <- select(data,  HGSHS.A3:HGSHS.A10)
```

Headers for the resulting table:
```{r echo=FALSE}
colnames(hab_purified)
```

### P = 0.15

Classify the data with .15 base rate:
```{r}
hab_pur15 <- ClassifyCases(hab_purified, p = 0.15)
```

Check the data:
```{r error = TRUE}
CheckData(hab_pur15)
```

### P = 0.10

Classify the data with .10 base rate:
```{r}
hab_pur10 <- ClassifyCases(hab_purified, p = 0.10)
```

Check the data:
```{r error = TRUE}
CheckData(hab_pur10)
```

## Hypnotic suggestibility data: subscales

Create subscales
```{r}
hab$ideomotor <- hab$HGSHS.A1 + hab$HGSHS.A2 + hab$HGSHS.A3 + hab$HGSHS.A7
hab$challenge <- hab$HGSHS.A4 + hab$HGSHS.A5 + hab$HGSHS.A6 + hab$HGSHS.A8 + hab$HGSHS.A10
hab$cogper <- hab$HGSHS.A9 + hab$HGSHS.A11
hab$amnesia <- hab$HGSHS.A12
```

Headers for the resulting table (showing only subscales columns):
```{r echo=FALSE}
select(hab, ideomotor, challenge, cogper, amnesia) %>%
  colnames()
```

### P = 0.15

Classify the data with .15 base rate:
```{r}
hab_subsc15 <- select(hab, ideomotor, challenge, cogper, amnesia)
hab_subsc15 <- ClassifyCases(hab_subsc15, p = 0.15)
```

Check the data:
```{r error = TRUE}
CheckData(hab_subsc15)
```

### P = 0.10

Classify the data with .10 base rate:
```{r}
hab_subsc10 <- select(hab, ideomotor, challenge, cogper, amnesia)
hab_subsc10 <- ClassifyCases(hab_subsc10, p = 0.10)
```

Check the data:
```{r error = TRUE}
CheckData(hab_subsc10)
```

## Hypnotic suggestibility data: subscales ("bad" items removed)

Create subscales
```{r}
hab_purified$ideomotor <- hab_purified$HGSHS.A3 + hab_purified$HGSHS.A7
hab_purified$challenge <- hab_purified$HGSHS.A4 + hab_purified$HGSHS.A5 + hab_purified$HGSHS.A6 + hab_purified$HGSHS.A8 + hab_purified$HGSHS.A10
hab_purified$cogper <- hab_purified$HGSHS.A9
```

Headers for the resulting table (showing only subscales columns):
```{r echo=FALSE}
select(hab, ideomotor, challenge, cogper) %>%
  colnames()
```

### P = 0.15

Classify the data with .15 base rate:
```{r}
hab_subsc_pur15 <- select(hab, ideomotor, challenge, cogper)
hab_subsc_pur15 <- ClassifyCases(hab_subsc_pur15, p = 0.15)
```

Check the data:
```{r error = TRUE}
CheckData(hab_subsc_pur15)
```

### P = 0.10

Classify the data with .10 base rate:
```{r}
hab_subsc_pur10 <- select(hab, ideomotor, challenge, cogper)
hab_subsc_pur10 <- ClassifyCases(hab_subsc_pur10, p = 0.10)
```

Check the data:
```{r error = TRUE}
CheckData(hab_subsc_pur10)
```

# Performing the analysis

## Involuntariness data: separate items

### P = 0.15

![Low mean!](warning.png){width=2%} Mean d = 1.09

```{r error = TRUE}
RunTaxometrics(invol15)
```

### P = 0.10

Mean d = ???

```{r error = TRUE}
RunTaxometrics(invol10)
```

## Involuntariness data: separate items ("bad" items removed)

### P = 0.15

![Low mean!](warning.png){width=2%} Mean d = 1.18

```{r error = TRUE}
RunTaxometrics(invol_pur15)
```

### P = 0.10

Mean d = ???

```{r error = TRUE}
RunTaxometrics(invol_pur10)
```

## Involuntariness data: subscales

### P = 0.15

```{r error = TRUE}
RunTaxometrics(invol_subscales15)
```

### P = 0.10

Mean d = ???

```{r error = TRUE}
RunTaxometrics(invol_subscales10)
```

## Involuntariness data: subscales ("bad" items removed)

### P = 0.15

```{r error = TRUE}
RunTaxometrics(invol_subscales_pur15)
```

### P = 0.10

Mean d = ???

```{r error = TRUE}
RunTaxometrics(invol_subscales_pur10)
```


## Hypnotic suggestibility data: separate items

### P = 0.15

![Low mean!](warning.png){width=2%} Mean d = 0.90

```{r error = TRUE}
RunTaxometrics(hab15)
```

### P = 0.10

Mean d = ???

```{r error = TRUE}
RunTaxometrics(hab10)
```

## Hypnotic suggestibility data: separate items ("bad" items removed)

### P = 0.15

![Low mean!](warning.png){width=2%} Mean d = 1.03

```{r error = TRUE}
RunTaxometrics(hab15)
```

### P = 0.10

Mean d = ???

```{r error = TRUE}
RunTaxometrics(hab10)
```

## Hypnotic suggestibility data: subscales

### P = 0.15

```{r error = TRUE}
RunTaxometrics(hab_subsc15)
```

### P = 0.10

Mean d = ???

```{r error = TRUE}
RunTaxometrics(hab_subsc10)
```

## Hypnotic suggestibility data: subscales ("bad" items removed)

### P = 0.15

```{r error = TRUE}
RunTaxometrics(hab_subsc_pur15)
```

### P = 0.10

Mean d = ???

```{r error = TRUE}
RunTaxometrics(hab_subsc_pur10)
```